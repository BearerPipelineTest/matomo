(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["Marketplace"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["Marketplace"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(l,a,function(t){return e[t]}.bind(null,a));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Marketplace/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8a95":function(e,t){},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"Marketplace",(function(){return g})),n.d(t,"LicenseKey",(function(){return J})),"undefined"!==typeof window){var l=window.document.currentScript,a=l&&l.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(n.p=a[1])}var o=n("8bbf"),r={class:"row marketplaceActions"},i={class:"col s12 m6 l4"},c={class:"col s12 m6 l4"},s={key:0,class:"col s12 m12 l4 "},u=["action"];function d(e,t,n,l,a,d){var p=Object(o["resolveComponent"])("Field");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",r,[Object(o["createElementVNode"])("div",i,[Object(o["createVNode"])(p,{uicontrol:"select",name:"plugin_type","model-value":e.pluginTypeFilter,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.pluginTypeFilter=t,e.changePluginType()}),title:e.translate("Marketplace_Show"),"full-width":!0,options:e.pluginTypeOptions},null,8,["model-value","title","options"])]),Object(o["createElementVNode"])("div",c,[Object(o["createVNode"])(p,{uicontrol:"select",name:"plugin_sort","model-value":e.pluginSort,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.pluginSort=t,e.changePluginSort()}),title:e.translate("Marketplace_Sort"),"full-width":!0,options:e.pluginSortOptions},null,8,["model-value","title","options"])]),e.pluginsToShow.length>20||e.query?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",s,[Object(o["createElementVNode"])("form",{method:"post",class:"plugin-search",action:e.pluginSearchFormAction,ref:"pluginSearchForm"},[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(p,{uicontrol:"text",name:"query",title:e.queryInputTitle,"full-width":!0,modelValue:e.searchQuery,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.searchQuery=t})},null,8,["title","modelValue"])]),Object(o["createElementVNode"])("span",{class:"icon-search",onClick:t[3]||(t[3]=function(t){return e.$refs.pluginSearchForm.submit()})})],8,u)])):Object(o["createCommentVNode"])("",!0)])}var p=n("19dc"),m=n("a5a2"),b=function(e){return"".concat(e[0].toLowerCase()).concat(e.substring(1))},f=Object(o["defineComponent"])({props:{pluginType:{type:String,required:!0},pluginTypeOptions:{type:[Object,Array],required:!0},sort:{type:String,required:!0},pluginSortOptions:{type:[Object,Array],required:!0},pluginsToShow:{type:Array,required:!0},query:{type:String,default:""},numAvailablePlugins:{type:Number,required:!0}},components:{Field:m["Field"]},data:function(){return{pluginSort:this.sort,pluginTypeFilter:this.pluginType,searchQuery:this.query}},methods:{changePluginSort:function(){p["MatomoUrl"].updateLocation(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),{},{query:"",sort:this.pluginSort}))},changePluginType:function(){p["MatomoUrl"].updateLocation(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),{},{query:"",show:this.pluginType}))}},computed:{pluginSearchFormAction:function(){return p["MatomoUrl"].stringify(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),{},{sort:"",embed:"0"}))},queryInputTitle:function(){var e=b(Object(p["translate"])("General_Plugins"));return"".concat(Object(p["translate"])("General_Search")," ").concat(this.numAvailablePlugins," ").concat(e,"...")}}}),y=n("8a95"),O=n.n(y);f.render=d,"function"===typeof O.a&&O()(f);var g=f,j={class:"marketplace-max-width"},v={class:"marketplace-paid-intro"},h={key:0},k={key:0},V=Object(o["createElementVNode"])("br",null,null,-1),P={class:"licenseToolbar valign-wrapper"},N=["href"],S={key:0},L={href:"javascript:;",class:"btn installAllPaidPlugins valign"},A={class:"ui-confirm",id:"installAllPaidPluginsAtOnce"},E=Object(o["createElementVNode"])("br",null,null,-1),M=Object(o["createElementVNode"])("br",null,null,-1),U=["href","value"],K=["value"],B={key:1},T={key:0},_=["innerHTML"],C=Object(o["createElementVNode"])("br",null,null,-1),w={class:"licenseToolbar valign-wrapper"},x={key:1},I=["innerHTML"],q={class:"ui-confirm",id:"confirmRemoveLicense",ref:"confirmRemoveLicense"},F=["value"],D=["value"];function H(e,t,n,l,a,r){var i=Object(o["resolveComponent"])("DefaultLicenseKeyFields"),c=Object(o["resolveComponent"])("SaveButton"),s=Object(o["resolveComponent"])("ActivityIndicator");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",j,[Object(o["createElementVNode"])("div",v,[e.isValidConsumer?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",h,[e.isSuperUser?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",k,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("Marketplace_PaidPluginsWithLicenseKeyIntro",""))+" ",1),V,Object(o["createElementVNode"])("div",P,[Object(o["createVNode"])(i,{"model-value":e.licenseKey,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.licenseKey=t,e.updatedLicenseKey()}),onConfirm:t[1]||(t[1]=function(t){return e.updateLicense()}),"has-license-key":e.hasLicenseKey,"is-valid-consumer":e.isValidConsumer,"enable-update":e.enableUpdate},null,8,["model-value","has-license-key","is-valid-consumer","enable-update"]),Object(o["createVNode"])(c,{class:"valign",id:"remove_license_key",onConfirm:t[2]||(t[2]=function(t){return e.removeLicense()}),value:e.translate("Marketplace_RemoveLicenseKey")},null,8,["value"]),Object(o["createElementVNode"])("a",{class:"btn valign",href:e.subscriptionOverviewLink},Object(o["toDisplayString"])(e.translate("Marketplace_ViewSubscriptions")),9,N),e.showInstallAllPaidPlugins?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",S,[Object(o["createElementVNode"])("a",L,Object(o["toDisplayString"])(e.translate("Marketplace_InstallPurchasedPlugins")),1),Object(o["createElementVNode"])("div",A,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("Marketplace_InstallAllPurchasedPlugins")),1),Object(o["createElementVNode"])("p",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("Marketplace_InstallThesePlugins"))+" ",1),E,M]),Object(o["createElementVNode"])("ul",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.paidPluginsToInstallAtOnce,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:e},Object(o["toDisplayString"])(e),1)})),128))]),Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("input",{role:"install",type:"button",href:e.installAllPaidPluginsLink,value:e.translate("Marketplace_InstallAllPurchasedPluginsAction",e.paidPluginsToInstallAtOnce.length)},null,8,U),Object(o["createElementVNode"])("input",{role:"cancel",type:"button",value:e.translate("General_Cancel")},null,8,K)])])])):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])(s,{loading:e.isUpdating},null,8,["loading"])])):Object(o["createCommentVNode"])("",!0)])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",B,[e.isSuperUser?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",T,[Object(o["createElementVNode"])("span",{innerHTML:e.$sanitize(e.noLicenseKeyIntroText)},null,8,_),C,Object(o["createElementVNode"])("div",w,[Object(o["createVNode"])(i,{"model-value":e.licenseKey,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.licenseKey=t,e.updatedLicenseKey()}),onConfirm:t[4]||(t[4]=function(t){return e.updateLicense()}),"has-license-key":e.hasLicenseKey,"is-valid-consumer":e.isValidConsumer,"enable-update":e.enableUpdate},null,8,["model-value","has-license-key","is-valid-consumer","enable-update"])]),Object(o["createVNode"])(s,{loading:e.isUpdating},null,8,["loading"])])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",x,[Object(o["createElementVNode"])("span",{innerHTML:e.$sanitize(e.noLicenseKeyIntroNoSuperUserAccessText)},null,8,I)]))]))]),Object(o["createElementVNode"])("div",q,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("Marketplace_ConfirmRemoveLicense")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,F),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,D)],512)])}var $={class:"valign licenseKeyText"};function G(e,t,n,l,a,r){var i=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("SaveButton");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",$,[Object(o["createVNode"])(i,{uicontrol:"text",name:"license_key","full-width":!0,"model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)}),placeholder:e.licenseKeyPlaceholder},null,8,["model-value","placeholder"])]),Object(o["createVNode"])(c,{class:"valign",onConfirm:t[1]||(t[1]=function(t){return e.$emit("confirm")}),disabled:!e.enableUpdate,value:e.saveButtonText,id:"submit_license_key"},null,8,["disabled","value"])],64)}var R=Object(o["defineComponent"])({props:{modelValue:String,isValidConsumer:Boolean,hasLicenseKey:Boolean,enableUpdate:Boolean},emits:["update:modelValue","confirm"],components:{Field:m["Field"],SaveButton:m["SaveButton"]},computed:{licenseKeyPlaceholder:function(){return this.isValidConsumer?Object(p["translate"])("Marketplace_LicenseKeyIsValidShort"):Object(p["translate"])("Marketplace_LicenseKey")},saveButtonText:function(){return this.hasLicenseKey?Object(p["translate"])("CoreUpdater_UpdateTitle"):Object(p["translate"])("Marketplace_ActivateLicenseKey")}}});R.render=G;var Q=R,z=Object(o["defineComponent"])({props:{isValidConsumer:Boolean,isSuperUser:Boolean,isAutoUpdatePossible:Boolean,isPluginsAdminEnabled:Boolean,hasLicenseKey:Boolean,paidPluginsToInstallAtOnce:{type:Array,required:!0},installNonce:{type:String,required:!0}},components:{SaveButton:m["SaveButton"],ActivityIndicator:p["ActivityIndicator"],DefaultLicenseKeyFields:Q},data:function(){return{licenseKey:"",enableUpdate:!1,isUpdating:!1}},methods:{updateLicenseKey:function(e,t,n){var l=this;p["AjaxHelper"].post({module:"API",method:"Marketplace.".concat(e),format:"JSON"},{licenseKey:this.licenseKey},{withTokenInUrl:!0}).then((function(e){l.isUpdating=!1,e&&e.value&&(p["NotificationsStore"].show({message:n,context:"success",type:"transient"}),p["Matomo"].helper.redirect())}),(function(){l.isUpdating=!1}))},removeLicense:function(){var e=this;p["Matomo"].helper.modalConfirm(this.$refs.confirmRemoveLicense,{yes:function(){e.enableUpdate=!1,e.isUpdating=!0,e.updateLicenseKey("deleteLicenseKey","",Object(p["translate"])("Marketplace_LicenseKeyDeletedSuccess"))}})},updatedLicenseKey:function(){this.enableUpdate=!!this.licenseKey},updateLicense:function(){this.enableUpdate=!1,this.isUpdating=!0,this.updateLicenseKey("saveLicenseKey",this.licenseKey,Object(p["translate"])("Marketplace_LicenseKeyActivatedSuccess"))}},computed:{subscriptionOverviewLink:function(){return"?".concat(p["MatomoUrl"].stringify(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),{},{action:"subscriptionOverview"})))},noLicenseKeyIntroText:function(){return Object(p["translate"])("Marketplace_PaidPluginsNoLicenseKeyIntro",'<a target="_blank" rel="noreferrer noopener" href="https://matomo.org/recommends/premium-plugins/">',"</a>")},noLicenseKeyIntroNoSuperUserAccessText:function(){return Object(p["translate"])("Marketplace_PaidPluginsNoLicenseKeyIntroNoSuperUserAccess",'<a target="_blank" rel="noreferrer noopener" href="https://matomo.org/recommends/premium-plugins/">',"</a>")},installAllPaidPluginsLink:function(){return"?".concat(p["MatomoUrl"].stringify(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),{},{action:"installAllPaidPlugins",nonce:this.installNonce})))},showInstallAllPaidPlugins:function(){return this.isAutoUpdatePossible&&this.isPluginsAdminEnabled&&this.paidPluginsToInstallAtOnce.length}}});z.render=H;var J=z;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=Marketplace.umd.min.js.map